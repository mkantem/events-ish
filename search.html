---
layout: default
title: "Search"
---

<h1>Search Events</h1>
<input type="text" id="search-box" placeholder="Type to search..." style="width: 100%; padding: 10px; margin-bottom: 20px;">

<ul id="results-container"></ul>

<script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js"></script>

<script>
  var idx = lunr(function () {
    this.ref('id');
    this.field('title', { boost: 10 });
    this.field('content');
    this.field('author');
    this.field('tags');

    {% for post in site.posts %}
    this.add({
      "id": {{ forloop.index }},
      "title": "{{ post.title | escape }}",
      "content": "{{ post.content | strip_html | escape }}",
      "author": "{{ post.author | escape }}",
      "tags": "{{ post.tags | array_to_sentence_string | escape }}",
      "url": "{{ post.url | relative_url }}"
    });
    {% endfor %}
  });

  var posts = [
    {% for post in site.posts %}
    {
      "id": {{ forloop.index }},
      "title": "{{ post.title | escape }}",
      "url": "{{ post.url | relative_url }}",
    }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ];

  document.getElementById('search-box').addEventListener('input', function() {
    var query = this.value;
    var results = idx.search(query);
    var resultsContainer = document.getElementById('results-container');
    resultsContainer.innerHTML = '';

    if (results.length === 0) {
      resultsContainer.innerHTML = '<li>No results found</li>';
    } else {
      results.forEach(function(result) {
        var post = posts.find(p => p.id == result.ref);
        var li = document.createElement('li');
        li.innerHTML = '<a href="' + post.url + '">' + post.title + '</a>';
        resultsContainer.appendChild(li);
      });
    }
  });
</script>
